<style type="text/css" media="screen">
/*
.nodes-image {
	margin:-100;
}
*/	
    .imageblock .content img {
        max-width: 900px;
        max-height: 300px;
    }
	.deck h3 {
		display: block !important;
		margin-bottom:8px;
		margin-top:5px;
	}
	.listingblock {
		margin:8px;
	}
	.pull-bottom {
		position:relative;
		bottom:1em;
	}
</style>
<style type="text/css" media="screen">
#editor.maximize-editor .CodeMirror-code {
 font-size:40px;
 line-height:45px;
}
</style><article class="guide">
  <carousel class="deck container-fluid">
    <!--slide class="row-fluid">
      <div class="col-sm-3">
        <h3>Venues</h3>
        <p class="lead">Information</p>
			<!dl>
				
				
				
				
				
			</dl>
		</div>
      <div class="col-sm-9">
        <figure>
          <img style="width:300px" src=""/>
        </figure>
      </div>
    </slide-->
    


<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Venues</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>One of the most important factors influencing which events people attend is where those events are being hosted.
In this section we&#8217;re going to introduce venues into the graph and then use those in our recommendation queries.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll start by seeing what data we&#8217;ve got on venues:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable code runnable"><code class="cypher language-cypher">LOAD CSV WITH HEADERS
FROM "https://raw.githubusercontent.com/neo4j-meetups/modeling-worked-example/master/data/venues.csv"
AS row
RETURN row
LIMIT 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>So we&#8217;ve got a venue id, name and then some address details including the lat and long.
Let&#8217;s get that imported!</p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise: Importing venues</h3>
    <br/>
    <div>
      <div class="ulist">
<ul>
<li>
<p>Load the venues into the graph - make sure you store <code>latitude</code> and <code>longitude</code> as properties as we&#8217;ll be using those in the next section.</p>
</li>
<li>
<p>Connect the events we loaded earlier to our newly loaded venues</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>Tip</em> You&#8217;ll have to iterate over the events CSV file again to get the <code>venue_id</code> for each event</p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Verifying venues import</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>Hopefully you&#8217;ve got <code>latitude</code> and <code>longitude</code> properties on each of the venues we just imported.
You can check by running the following query:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable code runnable"><code class="cypher language-cypher">MATCH (venue:Venue)
WHERE EXISTS(venue.latitude) AND EXISTS(venue.longitude)
RETURN COUNT(*)</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should see a count &gt; 0.
If you don&#8217;t then grab one of the trainers and we can help you fix it.</p>
</div>
<div class="paragraph">
<p>Next we&#8217;re going to do some distance calculations with those values.</p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Distance to venues</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>We&#8217;ll start with a simple query to find venues near here:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable code runnable"><code class="cypher language-cypher">WITH {latitude: 51.518551, longitude: -0.086114} AS graphConnectTrainingVenue
MATCH (venue:Venue)

WITH venue, distance(venue, graphConnectTrainingVenue) AS distance
RETURN venue, distance
ORDER BY distance
LIMIT 10</code></pre>
</div>
</div>
<div class="paragraph">
<p>This query</p>
</div>
<div class="ulist">
<ul>
<li>
<p>specifies our current location in a variable called <code>graphConnectTrainingVenue</code></p>
</li>
<li>
<p>iterates over all venues</p>
</li>
<li>
<p>calculates the distance from our current location to each venue</p>
</li>
<li>
<p>returns the 10 closest venues to us along with the distance in metres.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Try changing the first line to point to some other lat/longs in London.
e.g. the QE2 where Graph Connect will be tomorrow is at <code>51.5002221,-0.1290273</code></p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise: Using venues in recommendations</h3>
    <br/>
    <div>
      <div class="ulist">
<ul>
<li>
<p>Update the events recommendation query we wrote earlier to return the distance to here</p>
</li>
<li>
<p>Filter out events which are more than 1km away</p>
</li>
</ul>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Next Step</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>Can we now make use of previous locations where people have attended events to help make better recommendations?</p>
</div>
<div class="paragraph">
<p><a play-topic='http://localhost:8001/06_rsvps.html'>RSVPs</a></p>
</div>
	</div>
  </div>
</slide>
  </carousel>
</article>