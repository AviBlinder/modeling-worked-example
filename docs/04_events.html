<style type="text/css" media="screen">
/*
.nodes-image {
	margin:-100;
}
*/	
    .imageblock .content img {
        max-width: 900px;
        max-height: 300px;
    }
	.deck h3 {
		display: block !important;
		margin-bottom:8px;
		margin-top:5px;
	}
	.listingblock {
		margin:8px;
	}
	.pull-bottom {
		position:relative;
		bottom:1em;
	}
</style>
<style type="text/css" media="screen">
#editor.maximize-editor .CodeMirror-code {
 font-size:40px;
 line-height:45px;
}
</style><article class="guide">
  <carousel class="deck container-fluid">
    <!--slide class="row-fluid">
      <div class="col-sm-3">
        <h3>Events</h3>
        <p class="lead">Information</p>
			<!dl>
				
				
				
				
				
			</dl>
		</div>
      <div class="col-sm-9">
        <figure>
          <img style="width:300px" src=""/>
        </figure>
      </div>
    </slide-->
    


<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Events</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>So far we&#8217;ve only made recommendations for meetup groups that we might like to join.
Now it’s time to bring events into the graph.</p>
</div>
<div class="paragraph">
<p>We&#8217;ll start with exploration of the events csv file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable code runnable"><code class="cypher language-cypher">LOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/neo4j-meetups/modeling-worked-example/master/data/events.csv" AS row
RETURN row
LIMIT 5</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see we&#8217;ve got an event id, name, time, and description as well as some ids that reference other entities.</p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Import Events</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>First a bit of preparatory work before we import the events:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable code runnable"><code class="cypher language-cypher">CREATE INDEX ON :Event(id)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable code runnable"><code class="cypher language-cypher">CREATE INDEX ON :Event(time)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now we&#8217;re all set to import the events into the graph:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable code runnable"><code class="cypher language-cypher">USING PERIODIC COMMIT 10000
LOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/neo4j-meetups/modeling-worked-example/master/data/events.csv" AS row
MERGE (event:Event {id: row.id})
ON CREATE SET event.name = row.name,
              event.time = toInt(row.time),
              event.utcOffset = toInt(row.utc_offset)</code></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Connect events and groups</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>Our events are floating around not connected to anything so let&#8217;s resolve that.
We&#8217;ll use the <code>group_id</code> field from the CSV file to lookup a group that we created earlier and create a relationship between the event and group:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable code runnable"><code class="cypher language-cypher">USING PERIODIC COMMIT 10000
LOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/neo4j-meetups/modeling-worked-example/master/data/events.csv" AS row

WITH distinct row.group_id as groupId, row.id as eventId
MATCH (group:Group {id: groupId})
MATCH (event:Event {id: eventId})
MERGE (group)-[:HOSTED_EVENT]->(event)</code></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Find future events in my groups</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>The simplest event recommendation we can make is to find the groups we’re a member of and then find its future events.
We&#8217;ll start with that and build from there:</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable code runnable"><code class="cypher language-cypher">MATCH (member:Member {name: "Mark Needham"})-[:MEMBER_OF]->()-[:HOSTED_EVENT]->(futureEvent),
      (futureEvent)<-[:HOSTED_EVENT]-(group)
WHERE futureEvent.time > timestamp()
RETURN group.name,
       futureEvent.name,
       round((futureEvent.time - timestamp()) / (24.0*60*60*1000)) AS days
ORDER BY days</code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s a good start but it&#8217;s a bit restrictive - I&#8217;m never going to learn about events in groups that I haven&#8217;t joined yet.</p>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise:</h3>
    <br/>
    <div>
      
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Next Step</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>Next we&#8217;re going to introduce venues into the model so we can make recommendations based on where events are being held.</p>
</div>
<div class="paragraph">
<p><a play-topic='http://localhost:8001/05_venues.html'>VenuesRecommendations</a></p>
</div>
	</div>
  </div>
</slide>
  </carousel>
</article>